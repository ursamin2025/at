SELECT
  ts.ENDPOINT_BACKEND,
  CASE
    WHEN SUM(ts.STATUS = 'PASS') = COUNT(*) THEN 'UP'
    ELSE 'DOWN'
  END AS STATUS_INDICATOR
FROM cqeexecution.teststeps ts
WHERE ts.ENDPOINT_BACKEND IS NOT NULL
GROUP BY ts.ENDPOINT_BACKEND
ORDER BY ts.ENDPOINT_BACKEND;
