SELECT 
  ts.ENDPOINT_BACKEND,
  GROUP_CONCAT(DISTINCT ts.APP_NAME ORDER BY ts.APP_NAME SEPARATOR ', ') AS APP_NAMES,
  CASE 
    WHEN SUM(ts.STATUS = 'PASS') = COUNT(*) THEN 'UP'
    ELSE 'DOWN'
  END AS STATUS_INDICATOR
FROM cqeexecution.teststeps ts
JOIN cqeexecution.jenkins_execution je
  ON ts.ENDPOINT_BACKEND = je.JOB_DOMAIN
WHERE ts.ENDPOINT_BACKEND IS NOT NULL
  AND je.JOB_ENVIRONMENT = 'sit'
GROUP BY ts.ENDPOINT_BACKEND
ORDER BY ts.ENDPOINT_BACKEND;


SELECT DISTINCT ts.ENDPOINT_BACKEND
FROM cqeexecution.teststeps ts
WHERE ts.ENDPOINT_BACKEND IN (
  SELECT DISTINCT je.JOB_DOMAIN
  FROM cqeexecution.jenkins_execution je
  WHERE je.JOB_ENVIRONMENT = 'sit'
);
